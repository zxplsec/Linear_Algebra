\section{矩阵的初等变换与初等矩阵}

\begin{frame}
  \begin{footnotesize}
    用高斯消去法求解线性方程组，其步骤是对增广矩阵做以下三种行变换：
    \begin{itemize}
    \item[(i)] 对调两行\\[0.2cm]
    \item[(ii)] 以非零常数$k$乘矩阵的某一行\\[0.2cm]
    \item[(iii)] 将矩阵的某一行乘以常数$k$并加到另一行\\[0.4cm]
    \end{itemize}
    \pause 
    这三类行变换统称为\red{矩阵的初等行变换}，其中
    \begin{itemize}
    \item[(i)] \red{对换变换}  $\quad r_i \leftrightarrow r_j$
    \item[(ii)] \red{倍乘变换}       $\quad r_i \times k$
    \item[(iii)] \red{倍加变换} $\quad r_i + r_j \times k $\\[0.3cm]
    \end{itemize}
    \pause
    对应的还有\red{初等列变换}。 \blue{初等行变换与初等列变换统称为初等变换。}
    
  \end{footnotesize}
\end{frame}

\begin{frame}
  \begin{footnotesize}
    三种初等变换都是可逆的，且其逆变换是同一类型的初等变换。
    
    \begin{center}
      \begin{table}
        \caption{初等变换及其逆变换}
        \begin{tabular}{|c|c|} \hline
          初等变换 &  逆变换 \\\hline
          $r_i \leftrightarrow r_j$ & $r_i \leftrightarrow r_j$ \\[0.2cm]\hline
          $r_i \times k$ & $\disp r_i \times \frac1k$ \\[0.2cm]\hline
          $r_i + r_j \times k$ & $r_i - r_j\times k$ \\[0.2cm]\hline
        \end{tabular}
        
      \end{table}
    \end{center}
  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    \begin{block}{矩阵的等价}
      \begin{itemize}
      \item[(i)] 如果$\A$经过有限次初等行变换变成$\B$，就称\blue{$\A$与$\B$行等价}，记为$\red{\A\overset{r}{\sim} \B}$\\[0.2cm]
      \item[(ii)] 如果$\A$经过有限次初等列变换变成$\B$，就称\blue{$\A$与$\B$列等价}，记为$\red{\A\overset{c}{\sim} \B}$\\[0.2cm]
      \item[(iii)] 如果$\A$经过有限次初等变换变成$\B$，就称\blue{$\A$与$\B$等价}，记为$\red{\A\sim \B}$.
      \end{itemize}
    \end{block}
    \pause 
    \begin{block}{矩阵等价的性质}
      \begin{itemize}
      \item[(i)] \red{反身性}：$\A \sim \A$
      \item[(ii)] \red{对称性}：若$\A \sim \B$，则$\B \sim \A$
      \item[(iii)] \red{传递性}：若$\A \sim \B, ~\B \sim \C$，则$\A \sim \C$  
      \end{itemize}
    \end{block}
  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    \begin{block}{初等矩阵}
      将单位矩阵$\II$做一次初等变换所得的矩阵称为\red{初等矩阵}。
      \vspace{0.1in}

      对应于$3$类初等行、列变换，有$3$种类型的初等矩阵。
    \end{block}
  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    \begin{itemize}
    \item[(i)] 对调两行或对调两列（\red{初等对换矩阵}）
    \item[]
      \begin{center}
        \begin{tikzpicture}
          \matrix (M) [matrix of math nodes]  { 
            \E_{ij} = \\
          };
          \matrix(MM) [right=2pt of M, matrix of math nodes,nodes in empty cells,
            ampersand replacement=\&,left delimiter=(,right delimiter=)] {
            1 \&     \&   \&   \&     \&   \&   \& \& \\
              \& \dd \&   \&   \&     \&   \&   \& \& \\
              \&     \& 0 \&   \& \cd \&   \& 1 \& \& \\
              \&     \&   \& 1 \&     \&   \&   \& \& \\
              \&     \&\vd\&   \& \dd \&   \&\vd\& \& \\
              \&     \&   \&   \&     \& 1 \&   \& \& \\
              \&     \& 1 \&   \& \cd \&   \& 0 \& \& \\
              \&     \&   \&   \&     \&   \&   \& \dd \& \\
              \&     \&   \&   \&     \&   \&   \& \& 1\\
          };
          \node[right=12pt  of MM-3-9, blue]  {第$i$行};
          \node[right=12pt  of MM-7-9, blue]  {第$j$行};
          \node[below=12pt  of MM-9-3, blue]  {第$i$列};
          \node[below=12pt  of MM-9-7, blue]  {第$j$列};
        \end{tikzpicture}
      \end{center}
    \end{itemize}
  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    用$m$阶初等矩阵$\E_{ij}$左乘$\A=(a_{ij})_{m\times n}$，得
    \begin{center}
      \begin{tikzpicture}
        \matrix (M) [matrix of math nodes]  { 
          \E_{ij}\A = \\
        };
        \matrix(MM) [right=2pt of M, matrix of math nodes,nodes in empty cells,
          ampersand replacement=\&,left delimiter=(,right delimiter=)] {
          a_{11} \& a_{12}    \&   \&  a_{1n} \\
          \vd   \& \vd      \&   \&  \vd \\          
          a_{j1} \& a_{j2}    \&   \&  a_{jn} \\
          \vd   \& \vd      \&   \&  \vd \\
          a_{i1} \& a_{i2}    \&   \&  a_{in} \\
          \vd   \& \vd      \&   \&  \vd \\
          a_{m1} \& a_{m2}    \&   \&  a_{mn} \\
        };
        \node[right=12pt  of MM-3-4, blue]  {第$i$行};
        \node[right=12pt  of MM-5-4, blue]  {第$j$行};
      \end{tikzpicture}
    \end{center}
    \pause 
    其结果相当于：
    \begin{block}{}
      \red{把$\A$的第$i$行与第$j$行对调（$r_i \leftrightarrow r_j$）.}
    \end{block}
    \vspace{0.2in}

    \pause
    用$n$阶初等矩阵$\E_{ij}$右乘$\A$，且结果相当于
    \begin{block}{}
      \red{把$\A$的第$i$列与第$j$列对调（$c_i \leftrightarrow c_j$）.}
    \end{block}
  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    \begin{itemize}
    \item[(ii)] 以非零常数$k$乘某行或某列（初等倍乘矩阵）
       \begin{center}
        \begin{tikzpicture}
          \matrix (M) [matrix of math nodes]  { 
            \E_{i}(k) = \\
          };
          \matrix(MM) [right=2pt of M, matrix of math nodes,nodes in empty cells,
            ampersand replacement=\&,left delimiter=(,right delimiter=)] {
            1 \&     \&   \&   \&     \&   \& \\
              \& \dd \&   \&   \&     \&   \& \\
              \&     \& 1 \&   \&     \&   \& \\
              \&     \&   \& k \&     \&   \& \\
              \&     \&   \&   \& 1   \&   \& \\
              \&     \&   \&   \&     \& \dd \& \\
              \&     \&   \&   \&     \&   \& 1\\
          };
          \node[right=12pt  of MM-4-7, blue]  {第$i$行};
          \node[below=12pt  of MM-7-4, blue]  {第$i$列};
        \end{tikzpicture}
      \end{center}
      
    \end{itemize}
  \end{footnotesize}
\end{frame}

\begin{frame}
  \begin{footnotesize}
    \begin{itemize}
    \item[(1)] 以$m$阶初等矩阵$\E_i(k)$左乘$\A$，其结果相当于以数$k$乘$\A$的第$i$行（$r_i\times k$）\\[0.4cm]
    \item[(2)] 以$n$阶初等矩阵$\E_i(k)$右乘$\A$，其结果相当于以数$k$乘$\A$的第$i$列（$c_i\times k$）\\[0.4cm]
    \end{itemize}
  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    \begin{itemize}
    \item[(ii)] 以非零常数$k$乘某行或某列（初等倍乘矩阵）
       \begin{center}
        \begin{tikzpicture}
          \matrix (M) [matrix of math nodes]  { 
            \E_{ij}(k) = \\
          };
          \matrix(MM) [right=2pt of M, matrix of math nodes,nodes in empty cells,
            ampersand replacement=\&,left delimiter=(,right delimiter=)] {
            1 \&     \&   \&   \&     \&   \& \\
              \& \dd \&   \&   \&     \&   \& \\
              \&     \& 1 \&\cd\& k    \&   \& \\
              \&     \&   \&\dd\& \vd  \&   \& \\
              \&     \&   \&   \& 1   \&   \& \\
              \&     \&   \&   \&     \& \dd \& \\
              \&     \&   \&   \&     \&   \& 1\\
          };
          \node[right=12pt  of MM-3-7, blue]  {第$i$行};
          \node[right=12pt  of MM-5-7, blue]  {第$j$行};
        \end{tikzpicture}
      \end{center}
      
    \end{itemize}
  \end{footnotesize}
\end{frame}

\begin{frame}
  \begin{footnotesize}
    \begin{itemize}
    \item[(1)] 以$m$阶初等矩阵$\E_{ij}(k)$左乘$\A$，其结果相当于把$\A$的第$j$行乘以数$k$加到第$i$行上\red{（$r_i+r_j\times k$）}\\[0.4cm]
    \item[(2)] 以$n$阶初等矩阵$\E_{ij}(k)$右乘$\A$，其结果相当于把$\A$的第$i$列乘以数$k$加到第$j$列上\red{（$c_j+c_i\times k$）}
    \end{itemize}
  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    \begin{block}{定理}
      设$\A$为一个$m\times n$矩阵，
      \begin{itemize}
      \item 
        对$\A$施行一次初等行变换，相当于在$\A$的左边乘以相应的$m$阶初等矩阵；\\[0.3cm]
      \item
        对$\A$施行一次初等列变换，相当于在$\A$的右边乘以相应的$n$阶初等矩阵。
      \end{itemize}
    \end{block}
    \pause
    \vspace{0.1in}
    \begin{block}{总结}
      \begin{itemize}
      \item[] $\E_i(k)\A$
      \item[] $\E_{ij}(k)\A$
      \item[] $\E_{ij}\A$
      \item[] $\A\E_i(k)$
      \item[] $\A\E_{ij}(k)$
      \item[] $\A\E_{ij}$
      \end{itemize}
    \end{block}
    
  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    由初等变换可逆，可知初等矩阵可逆。 \pause 
    \begin{itemize}
    \item[(i)] 由\blue{变换$r_i\leftrightarrow r_j$的逆变换为其本身}可知
      $$
      \red{\E_{ij}^{-1} = \E_{ij}}
      $$\pause 
    \item[(ii)] 由\blue{变换$r_i\times k$的逆变换为$\disp r_i\times \frac1k$}可知
      $$
      \red{\E_{i}(k)^{-1} = \E_{i}(\frac1k)}
      $$\pause 
    \item[(iii)] 由\blue{变换$r_i+r_j\times k$的逆变换为$\disp r_i-r_j\times k$}可知
      $$
      \red{\E_{ij}(k)^{-1} = \E_{ij}(-k)}
      $$ 
    \end{itemize}

    \pause
    \begin{block}{}
    $$ \red{
    \E_{ij}\E_{ij}=\II, \quad
    \E_{i}(k)\E_{i}(\frac1k) = \II, \quad
    \E_{ij}(k)\E_{ij}(-k) = \II.
    }
    $$      
    \end{block}
  \end{footnotesize}
\end{frame}






\begin{frame}
  \begin{footnotesize}  
    \begin{exampleblock}{例1}
      设初等矩阵
      $$
      \PP_1 = \left(
      \begin{array}{cccc}
        0&0&1&0 \\
        0&1&0&0 \\
        1&0&0&0 \\
        0&0&0&1
      \end{array}
      \right), ~~
      \PP_2 = \left(
      \begin{array}{cccc}
        1& & &  \\
        0&1& &  \\
        0&0&1& \\
        c&0&0&1
      \end{array}
      \right), ~~
      \PP_3 = \left(
      \begin{array}{cccc}
        1& & &  \\
        &k& &  \\
        & &1& \\
        & & &1
      \end{array}
      \right)
      $$
      求$\PP_1\PP_2\PP_3$及$(\PP_1\PP_2\PP_3)^{-1}$
    \end{exampleblock}
    \pause 
    \jiename
    
    $$
    \PP_2\PP_3 =  \pause  \left(
    \begin{array}{cccc}
      1& & &  \\
      0&k& &  \\
      0&0&1& \\
      c&0&0&1
    \end{array}
    \right), \quad  \pause 
    \PP_1\PP_2\PP_3=\PP_1(\PP_2\PP_3) =\pause\left(
    \begin{array}{cccc}
      0&0&1&0 \\
      0&k&0&0  \\
      1&0&0&0  \\
      c&0&0&1
    \end{array}
    \right)
    $$



  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    \begin{exampleblock}{例1}
      设初等矩阵
      $$
      \PP_1 = \left(
      \begin{array}{cccc}
        0&0&1&0 \\
        0&1&0&0 \\
        1&0&0&0 \\
        0&0&0&1
      \end{array}
      \right), ~~
      \PP_2 = \left(
      \begin{array}{cccc}
        1& & &  \\
        0&1& &  \\
        0&0&1& \\
        c&0&0&1
      \end{array}
      \right), ~~
      \PP_3 = \left(
      \begin{array}{cccc}
        1& & &  \\
        &k& &  \\
        & &1& \\
        & & &1
      \end{array}
      \right)
      $$
      求$\PP_1\PP_2\PP_3$及$(\PP_1\PP_2\PP_3)^{-1}$
    \end{exampleblock}
    \pause 
    $$
    (\PP_1\PP_2\PP_3)^{-1} = \PP_3^{-1}\PP_2^{-1}\PP_1^{-1}
    $$
    \pause
    $$
    \PP_1^{-1} = \PP_1, ~~
    \PP_2^{-1} = \left(
    \begin{array}{cccc}
      1& & &  \\
      0&1& &  \\
      0&0&1& \\
      -c&0&0&1
    \end{array}
    \right), ~~
    \PP_3^{-1} = \left(
    \begin{array}{cccc}
      1& & &  \\
      &\frac1k& &  \\
      & &1& \\
      & & &1
    \end{array}
    \right)
    $$    
    \pause 
    $$
    \PP_2^{-1}\PP_1^{-1} =  \pause \left(
    \begin{array}{cccc}
      0&0&1&0 \\
      0&1&0&0 \\
      1&0&0&0 \\
      0&0&-c&1
    \end{array}
    \right), \quad \pause 
    \PP_3^{-1}\PP_2^{-1}\PP_1^{-1} = \pause \left(
    \begin{array}{cccc}
      0&0&1&0 \\
      0&\frac1k&0&0 \\
      1&0&0&0 \\
      0&0&-c&1
    \end{array}
    \right)
    $$
  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    \begin{exampleblock}{例2}
      将三对角矩阵
      $
      \A = \left(
      \begin{array}{cccc}
        2 & 1 & 0 & 0\\
        1 & 2 & 1 & 0\\
        0 & 1 & 2 & 1\\
        0 & 0 & 1 & 2
      \end{array}
      \right)
      $
      分解成主对角元为$1$的下三角矩阵$\mathbf{L}$和上三角阵$\mathbf{U}$的乘积$\A=\mathbf{L}\mathbf{U}$（称为矩阵的LU分解）。
    \end{exampleblock}
    \pause 
    \jiename 
    $$
    \left(
    \begin{array}{cccc}
      1 & && \\
      -\frac12 &1&&\\
      &&1&\\
      &&&1
    \end{array}
    \right)\A = \left(
    \begin{array}{cccc}
      2 & 1 & 0 & 0\\
      0 & \frac32 & 1 & 0\\
      0 & 1 & 2 & 1\\
      0 & 0 & 1 & 2
    \end{array}
    \right) \triangleq \A_1
    $$
    \pause 
    $$
    \left(
    \begin{array}{cccc}
      1 & && \\
      &1&&\\
      &-\frac23&1&\\
      &&&1
    \end{array}
    \right)\A_1 = \left(
    \begin{array}{cccc}
      2 & 1 & 0 & 0\\
      0 & \frac32 & 1 & 0\\
      0 & 0 & \frac43 & 1\\
      0 & 0 & 1 & 2
    \end{array}
    \right) \triangleq \A_2
    $$
    \pause 

    $$
    \left(
    \begin{array}{cccc}
      1 & && \\
      &1&&\\
      &&1&\\
      &&-\frac34&1
    \end{array}
    \right)\A_2 = \left(
    \begin{array}{cccc}
      2 & 1 & 0 & 0\\
      0 & \frac32 & 1 & 0\\
      0 & 0 & \frac43 & 1\\
      0 & 0 & 0  & \frac54
    \end{array}
    \right) \triangleq \mathbf{U}
    $$
  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    将上面三个式子中左端的矩阵分别记为$\mathbf{L}_1,\mathbf{L}_2,\mathbf{L}_3$，则
    $$
    \mathbf{L}_3\mathbf{L}_2\mathbf{L}_1 \A = \mathbf{U}
    $$
    \pause 
    于是
    $$
    \A = (\mathbf{L}_3\mathbf{L}_2\mathbf{L}_1)^{-1}\mathbf{U} \triangleq \mathbf{L}\mathbf{U} 
    $$
    \pause 
    其中
    $$
    \begin{array}{rcl}
      \mathbf{L} &=& (\mathbf{L}_3\mathbf{L}_2\mathbf{L}_1)^{-1} 
      =  \mathbf{L}_1^{-1}\mathbf{L}_2^{-1}\mathbf{L}_3^{-1}\\[0.2cm]
      &=&  
\left(
    \begin{array}{cccc}
      1 & && \\
      \frac12 &1&&\\
      &&1&\\
      &&&1
    \end{array}
    \right)
 \left(
    \begin{array}{cccc}
      1 & && \\
      &1&&\\
      &\frac23&1&\\
      &&&1
    \end{array}
    \right)
      \left(
    \begin{array}{cccc}
      1 & && \\
      &1&&\\
      &&1&\\
      &&\frac34&1
    \end{array}
    \right) \\[0.6cm]
      &=&   \left(
    \begin{array}{cccc}
      1 & && \\
      \frac12 &1&&\\
      &\frac23&1&\\
      &&\frac34&1
    \end{array}
    \right)
    \end{array}    
    $$
  \end{footnotesize}
\end{frame}

\begin{frame}
  \begin{footnotesize}
    \begin{block}{定理2}
      可逆矩阵可以经过若干次初等行变换化为单位矩阵。
    \end{block}
    \pause
    \proofname
    对于高斯消去法，其消去过程是对增广矩阵做$3$类初等行变换，并一定可以将其化为行简化阶梯形矩阵。\pause 
    因此，对于任何矩阵$\A$，都可经过初等行变换将其化为行简化阶梯形矩阵，即存在初等矩阵$\PP_1,\PP_2,\cd,\PP_s$使得
    $$
    \PP_s \cd \PP_2 \PP_1 \A = \mathbf{U}
    $$
    \pause
    当$\A$为$n$阶可逆矩阵时，行简化阶梯形矩阵也是可逆矩阵，从而$\mathbf{U}$必为单位矩阵$\II$.
  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    \begin{block}{推论1}
      可逆矩阵$\A$可以表示为若干个初等矩阵的乘积。
    \end{block}
    \pause
    \proofname
    由上述定理，必存在初等矩阵$\PP_1,\PP_2,\cd,\PP_s$使得
    $$
    \PP_s \cd \PP_2 \PP_1 \A = \II,
    $$
    于是
    $$
    \A = (\PP_s \cd \PP_2 \PP_1)^{-1} = \PP_1^{-1}\PP_2^{-1}\cd\PP_s^{-1}
    $$
  \end{footnotesize}
\end{frame}

\begin{frame}
  \begin{footnotesize}
    \begin{block}{推论1}
      如果对可逆矩阵$\A$与同阶单位矩阵$\II$做同样的初等行变换，那么当$\A$变为单位阵时，
      $\II$就变为$\A^{-1}$，即
      $$\red{
      \left(
      \begin{array}{cc}
        \A & \II
      \end{array}
      \right) \xrightarrow[]{\mbox{初等行变换}} \left(
      \begin{array}{cc}
        \II & \A^{-1}
      \end{array}
      \right)
      } 
      $$
    \end{block}
    \vspace{0.1in}
    
   \pause
   同理，
    $$\red{
      \left(
      \begin{array}{c}
        \A\\
        \II
      \end{array}
      \right) \xrightarrow[]{\mbox{初等列变换}} \left(
      \begin{array}{c}
        \II \\
        \A^{-1}
      \end{array}
      \right)
      } 
      $$
  \end{footnotesize}
\end{frame}

\begin{frame}
  \begin{footnotesize}
    \begin{exampleblock}{例3}
      求$
      \A=\left(
      \begin{array}{rrr}
        0&2&-1\\
        1&1&2\\
        -1&-1&-1
      \end{array}
      \right)
      $
      的逆矩阵。
    \end{exampleblock}
    \pause
    \jiename
    \begin{center}
      \begin{tikzpicture}
        \matrix(M) [matrix of math nodes,nodes in empty cells,,ampersand replacement=\&,left delimiter=(,right delimiter=)]{
          \A \& \& \II \\
        };
        \draw[dashed] (M-1-2.north) -- (M-1-2.south);
        \matrix(M1) [right=.1in of M,matrix of math nodes]{
          = \\
        };
        \matrix(MM1) [right=.1in of M1,matrix of math nodes,nodes in empty cells,
          column sep=1ex,row sep=.5ex,ampersand replacement=\&,left delimiter=(,right delimiter=)] {
          0 \&  2 \& -1 \& \& 1 \& 0 \& 0\\
          1 \&  1 \&  2 \& \& 0 \& 1 \& 0\\
          -1 \& -1 \& -1 \& \& 0 \& 0 \& 1\\            
        };
        \draw[dashed] (MM1-1-4.north) -- (MM1-3-4);       
        \pause
        
        \matrix(M2) [below=.4in of M1,matrix of math nodes]{
          \xrightarrow[]{r_1\leftrightarrow r_2} \\
        };
        \matrix(MM2) [right=.1in of M2,matrix of math nodes,nodes in empty cells,
          column sep=1ex,row sep=.5ex,ampersand replacement=\&,left delimiter=(,right delimiter=)] {         
          1 \&  1 \&  2 \& \& 0 \& 1 \& 0\\
          0 \&  2 \& -1 \& \& 1 \& 0 \& 0\\
          -1 \& -1 \& -1 \& \& 0 \& 0 \& 1\\          
        };
        \draw[dashed] (MM2-1-4.north) -- (MM2-3-4);
        \pause 

        \matrix(M3) [below=.4in of M2,matrix of math nodes]{
          \xrightarrow[]{r_3+ r_1} \\
        };
        \matrix(MM3) [right=.1in of M3,matrix of math nodes,nodes in empty cells,
          column sep=1ex,row sep=.5ex,ampersand replacement=\&,left delimiter=(,right delimiter=)] {         
          1 \&  1 \&  2 \& \& 0 \& 1 \& 0\\
          0 \&  2 \& -1 \& \& 1 \& 0 \& 0\\
          0 \&  0 \&  1 \& \& 0 \& 1 \& 1\\          
        };
        \draw[dashed] (MM3-1-4.north) -- (MM3-3-4);
      \end{tikzpicture}
    \end{center}
  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    \begin{center}
      \begin{tikzpicture}
        \matrix(MM3) [matrix of math nodes,nodes in empty cells,
          column sep=1ex,row sep=.5ex,ampersand replacement=\&,left delimiter=(,right delimiter=)] {         
          1 \&  1 \&  2 \& \& 0 \& 1 \& 0\\
          0 \&  2 \& -1 \& \& 1 \& 0 \& 0\\
          0 \&  0 \&  1 \& \& 0 \& 1 \& 1\\          
        };
        \draw[dashed] (MM3-1-4.north) -- (MM3-3-4);
        \pause
        
        \matrix(MM4) [below=.1in of MM3,matrix of math nodes,nodes in empty cells,
          column sep=1ex,row sep=.5ex,ampersand replacement=\&,left delimiter=(,right delimiter=)] {         
          1 \&  1 \&  0 \& \& 0 \&-1 \&-2\\
          0 \&  2 \&  0 \& \& 1 \& 1 \& 1\\
          0 \&  0 \&  1 \& \& 0 \& 1 \& 1\\          
        };
        \draw[dashed] (MM4-1-4.north) -- (MM4-3-4);
        \matrix(M4) [left=.1in of MM4,matrix of math nodes]{
          \xrightarrow[r_2+r_3]{r_1+ r_3\times(-2)} \\
        };
        \pause

        \matrix(MM5) [below=.1in of MM4,matrix of math nodes,nodes in empty cells,
          column sep=1ex,row sep=.5ex,ampersand replacement=\&,left delimiter=(,right delimiter=)] {         
          1 \&  0 \&  0 \& \& -\frac12 \&-\frac32 \&-\frac52\\
          0 \&  1 \&  0 \& \& \frac12 \& \frac12 \& \frac12\\
          0 \&  0 \&  1 \& \& 0 \& 1 \& 1\\          
        };
        \draw[dashed] (MM5-1-4.north) -- (MM5-3-4);
        \matrix(M5) [left=.1in of MM5,matrix of math nodes]{
          \xrightarrow[r_2\times \frac12]{r_1+ r_2\times(-\frac12)} \\
        };
      \end{tikzpicture}
      
    \end{center}
  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    \begin{exampleblock}{例4}
      已知$\A\B\A^T=2\B\A^T+\II$，求$\B$，其中$
      \A = \left(
      \begin{array}{ccc}
        1&0&0\\
        0&1&2\\
        0&0&1
      \end{array}
      \right)
      $
    \end{exampleblock}
    \pause
    \proofname
    $$
    \A\B\A^T=2\B\A^T+\II \Rightarrow (\A-2\II)\B\A^T=\II \pause
    \Rightarrow \B\A^T = (\A-2\II)^{-1}
    $$
    \pause 
    故
    $$
    \B = (\A-2\II)^{-1} (\A^T)^{-1} \pause = [\A^T(\A-2\II)]^{-1} \pause
    =(\A^T\A-2\A^T)^{-1}
    $$
    \pause
    $$
    \A^T\A-2\A^T = \left(
    \begin{array}{rrr}
      -1&0&0\\
      0&-1&2\\
      0&-2&3
    \end{array}
    \right)
    $$\pause 
    可求得
    $$
    \B = \left(
    \begin{array}{rrr}
      -1&0&0\\
      0&3&-2\\
      0&2&-1
    \end{array}
    \right)
    $$
  \end{footnotesize}
\end{frame}

\begin{frame}
  \begin{footnotesize}
    \begin{block}{推论}
      对于$n$个未知数$n$个方程的线性方程组
      $$
      \A\xx=\bb,
      $$
      如果增广矩阵
      $$
      \red{(\A,~\bb)~~\overset{r}{\sim}~~(\II,\xx)},
      $$
      则$\A$可逆，且$\xx=\A^{-1}\bb$为惟一解。
      
    \end{block}
  \end{footnotesize}
\end{frame}


\begin{frame}
  \begin{footnotesize}
    \begin{exampleblock}{例5}
      设
      $$
      \A = \left(
      \begin{array}{rrr}
        2&1&-3\\
        1&2&-3\\
        -1&3&2
      \end{array}
      \right),
      ~~
      \bb_1=\left(
      \begin{array}{r}
        1\\
        2\\
        -2
      \end{array}
      \right),
      ~~
      \bb_2=\left(
      \begin{array}{r}
        -1\\
         0\\
         5
      \end{array}
      \right),
      $$
      求$\A\xx=\bb_1$与$\A\xx=\bb_2$的解。
    \end{exampleblock}
    \pause 
    \jiename  
    $$
    \begin{array}{rl}
      (\A~~\red{\bb_1}~~\red{\bb_2}) &= \left(
      \begin{array}{rrrrr}
        2 & 1 & 3 &\red{ 1} & \red{-1}\\
        1 & 2 &-2 &\red{ 2} & \red{ 0}\\
       -1 & 3 & 2 &\red{-2} & \red{ 5}        
      \end{array}
      \right) \pause  \overset{{r_1\leftrightarrow r_2 \atop r_2-2r_1}\atop  r_3+r_1}{\sim}
      \left(
      \begin{array}{rrrrr}
        1 & 2 &-2 & \red{ 2} & \red{ 0}\\
        0 &-3 & 1 & \red{-3} & \red{-1}\\
        0 & 5 & 0 & \red{ 0} & \red{ 5}        
      \end{array}
      \right) \\[0.3in]
      &\pause \overset{{r_3\leftrightarrow r_2 \atop r_2\div5}\atop  r_3+3r_2}{\sim}
      \left(
      \begin{array}{rrrrr}
        1 & 2 &-2 &\red{ 2} &  \red{0}\\
        0 & 1 & 0 &\red{ 0} &  \red{1}\\
        0 & 0 & 1 &\red{-3} &  \red{2}        
      \end{array}
      \right) \pause  \overset{r_1-2r_2+2r_3}{\sim}
            \left(
      \begin{array}{rrrrr}
        1 & 0 & 0 & \red{-4} & \red{2}\\
        0 & 1 & 0 & \red{0} &  \red{1}\\
        0 & 0 & 1 & \red{-3} &  \red{2}        
      \end{array}
      \right) 
    \end{array}
    $$
  \end{footnotesize}
\end{frame}

\begin{frame}
\begin{footnotesize}
  \begin{exampleblock}{例6}
    求解矩阵方程$\A\XX=\A+\XX$，其中
    $
    \A = \left(
    \begin{array}{ccc}
      2&2&0\\
      2&1&3\\
      0&1&0
    \end{array}
    \right)
    $
  \end{exampleblock}
  \pause
  \jiename 原方程等价于
  $$
  (\A-\II)\XX=\A
  $$
  \pause
  $$
  \begin{array}{ll}
    (\A-\II ~~\red{\A})& =\left(
    \begin{array}{rrrrrr}
      1&2& 0&\red{2}&\red{2}&\red{0}\\
      2&0& 3&\red{2}&\red{1}&\red{3}\\
      0&1&-1&\red{0}&\red{1}&\red{0}
    \end{array}
    \right)
    \pause
    \overset{r_2-2r_1\atop r_2\leftrightarrow r_3}{\sim}
    \left(
    \begin{array}{rrrrrr}
      1& 2& 0&\red{ 2}&\red{ 2}&\red{0}\\
      0& 1&-1&\red{ 0}&\red{ 1}&\red{0}\\
      0&-4& 3&\red{-2}&\red{-3}&\red{3}
    \end{array}
    \right)    \\[0.2in]
    &\pause
    \overset{r_3+4r_2\atop r_3\div(-1)}{\sim}
    \left(
    \begin{array}{rrrrrr}
      1&2& 0&\red{2}&\red{ 2}&\red{ 0}\\
      0&1&-1&\red{0}&\red{ 1}&\red{ 0}\\
      0&0& 1&\red{2}&\red{-1}&\red{-3}
    \end{array}
    \right) \\[0.2in]
    & \pause 
    \overset{r_3+4r_2\atop r_3\div(-1)}{\sim}
    \left(
    \begin{array}{rrrrrr}
      1&0&0&\red{-2}&\red{2}&\red{6}\\
      0&1&0&\red{2}&\red{0}&\red{-3}\\
      0&0&1&\red{2}&\red{-1}&\red{-3}
    \end{array}
    \right)
  \end{array}
  $$
\end{footnotesize}  
\end{frame}

\begin{frame}
  \begin{footnotesize}
    \begin{exampleblock}{例7}
      当$a,b$满足什么条件时，矩阵$\A=\left(
      \begin{array}{rrrr}
        0&1&2&3\\
        1&4&7&10\\
        -1&0&1&b\\
        a&2&3&4
      \end{array}
      \right)$
      不可逆。
    \end{exampleblock}
    \pause
    \jiename
    \begin{center}
      \begin{tikzpicture}
        \matrix(M) [matrix of math nodes,nodes in empty cells,,ampersand replacement=\&]{
          \A \\
        };
        
        \matrix(M1) [right=.05in of M,matrix of math nodes]{
          \xrightarrow[c_2\leftrightarrow c_3]{c_1\leftrightarrow c_2} \\
        };
        \matrix(MM1) [right=.1in of M1,matrix of math nodes,nodes in empty cells,
          column sep=1ex,row sep=.5ex,ampersand replacement=\&,left delimiter=(,right delimiter=)] {
          1 \& 2 \& 0 \& 3\\
          4 \& 7 \& 1 \& 10\\
          0 \& 1 \& -1 \& b\\
          2 \& 3 \& a \& 4\\
        };
        \pause 
        \matrix(M2) [right=.1in of MM1,matrix of math nodes]{
          \xrightarrow[r_4+r_1\times(-2)]{r_2+r_1\times(-4)} \\
        };
        \matrix(MM2) [right=.1in of M2,matrix of math nodes,nodes in empty cells,
          column sep=1ex,row sep=.5ex,ampersand replacement=\&,left delimiter=(,right delimiter=)] {
          1 \& 2 \& 0 \& 3\\
          0 \& -1 \& 1 \& -2\\
          0 \& 1 \& -1 \& b\\
          0 \& -1 \& a \& -2\\
        };
        \pause 
        \matrix(M3) [below=.2in of MM1,matrix of math nodes]{
          \xrightarrow[r_4+r_2\times(-1)]{r_3+r_2} \\
        };
        \matrix(MM2) [right=.1in of M3,matrix of math nodes,nodes in empty cells,
          column sep=1ex,row sep=.5ex,ampersand replacement=\&,left delimiter=(,right delimiter=)] {
          1 \& 2 \& 0 \& 3\\
          0 \& -1 \& 1 \& -2\\
          0 \& 0 \& -1 \& b\\
          0 \& 0 \& a-1 \& 0\\
        };
      \end{tikzpicture}
    \end{center}

  \end{footnotesize}
\end{frame}
