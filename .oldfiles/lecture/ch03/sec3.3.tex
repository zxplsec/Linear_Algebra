\section{矩阵的秩 \quad 相抵标准形}
\begin{dingyi}[行秩 \& 列秩]
  \begin{itemize}
  \item
    对于矩阵$\A$，把它的每一行称为$\A$的一个\red{行向量}。
    把$\A$的行向量组的秩，称为矩阵$\A$的\red{行秩}。
  \item
    对于矩阵$\A$，把它的每一列称为$\A$的一个\red{列向量}。
    把$\A$的列向量组的秩，称为矩阵$\A$的\red{列秩}。
  \end{itemize}      
\end{dingyi}    
对于$m\times n$阶矩阵$\A$，
\begin{itemize}
\item $\A$的行秩$~\le~ m$；
\item $\A$的列秩$~\le~ n$。
\end{itemize}





阶梯形矩阵
\begin{figure}
  \centering
  \begin{tikzpicture}
    \matrix (M) [matrix of math nodes]  { 
      \A = \\
    };
    \matrix(MM) [right=.1in of M, matrix of math nodes,nodes in empty cells,
    column sep=3ex,row sep=1ex,ampersand replacement=\&,left delimiter=(,right delimiter=)] {
      a_{11} \& a_{12} \& a_{13}  \& a_{14} \& a_{15}\\
      0 \& 0 \& a_{23}  \& a_{24} \& a_{25}\\
      0 \& 0 \& 0  \& a_{34} \& a_{35}\\
      0 \& 0 \& 0  \& 0 \& 0\\
    };
    \draw[thick,red,dashed] (MM-2-1.north west)--(MM-2-2.north east)
    --(MM-3-2.north east)--(MM-3-3.north east)
    --(MM-4-3.north east)--(MM-4-5.north east);
  \end{tikzpicture}
\end{figure}
其中$a_{11}\ne0, a_{23}\ne 0, a_{34}\ne 0$。
\red{验证$\A$的行秩$=3$，列秩$=3$}。





把$\A$按行和列分块为
$$
\A = \left(
  \begin{array}{c}
    \alphabd_1\\
    \alphabd_2\\
    \alphabd_3\\
    \alphabd_4
  \end{array}
\right), \quad \B = (\betabd_1,\betabd_2,\betabd_3,\betabd_4,\betabd_5)
$$
下证$\alphabd_1,\alphabd_2,\alphabd_3$线性无关，$\betabd_1,\betabd_3,\betabd_4$线性无关。






\begin{itemize}
\item[(1)] 设
  $$
  x_1\alphabd_1+x_2\alphabd_2+x_3\alphabd_3=\zero,
  $$
  即
  $$
  x_1(a_{11},a_{12},a_{13},a_{14},a_{15})+
  x_2(0,0,a_{23},a_{24},a_{25})+
  x_3(0,0,0,a_{34},a_{35})=(0,0,0,0,0)
  $$  
  比较第一个分量
  $$
  x_1a_{11} = 0 \Rightarrow x_1=0.
  $$  从而
  $$
  x_2(0,0,a_{23},a_{24},a_{25})+
  x_3(0,0,0,a_{34},a_{35})=(0,0,0,0,0)
  $$  
  比较第3个分量
  $$
  x_2a_{23} = 0 \Rightarrow x_2=0.
  $$   从而
  $$
  x_3(0,0,0,a_{34},a_{35})=(0,0,0,0,0)
  $$ 
  同理得$x_3=0$。  于是$\alphabd_1,\alphabd_2,\alphabd_3$线性无关。 
  \vspace{0.1in}

  又$\alphabd_4=\zero$，而零向量可由任何向量线性表示，这里
  $$
  \zero = 0\alphabd_1+0\alphabd_2+0\alphabd_3.
  $$
  故$\alphabd_1,\alphabd_2,\alphabd_3$是向量组$\alphabd_1,\alphabd_2,\alphabd_3,\alphabd_4$的极大无关组。所以矩阵$\A$的行秩为3。
\end{itemize}






\begin{itemize}
\item[(2)] 设
  $$
  y_1\betabd_1 + y_3\betabd_3 + y_4\betabd_4=\zero
  $$
  即
  $$
  y_1\left(
    \begin{array}{c}
      a_{11}\\
      0\\
      0\\
      0
    \end{array}
  \right) + y_3\left(
    \begin{array}{c}
      a_{13}\\
      a_{23}\\
      0\\
      0
    \end{array}
  \right) + y_4\left(
    \begin{array}{c}
      a_{14}\\
      a_{24}\\
      a_{34}\\
      0
    \end{array}
  \right) = \left(
    \begin{array}{c}
      0\\
      0\\
      0\\
      0
    \end{array}
  \right)
  $$
  比较第三个分量得$y_4=0$。从而
  $$
  y_1\left(
    \begin{array}{c}
      a_{11}\\
      0\\
      0\\
      0
    \end{array}
  \right) + y_3\left(
    \begin{array}{c}
      a_{13}\\
      a_{23}\\
      0\\
      0
    \end{array}
  \right) = \left(
    \begin{array}{c}
      0\\
      0\\
      0\\
      0
    \end{array}
  \right)
  $$比较第二个分量得$y_3=0$。从而
  $$
  y_1\left(
    \begin{array}{c}
      a_{11}\\
      0\\
      0\\
      0
    \end{array}
  \right) = \left(
    \begin{array}{c}
      0\\
      0\\
      0\\
      0
    \end{array}
  \right)
  $$ 比较第一个分量得$y_1=0$。故$\betabd_1,\betabd_3,\betabd_4$线性无关。
\end{itemize}





\begin{figure}
  \centering
  \begin{tikzpicture}
    \matrix(MM) [ matrix of math nodes,nodes in empty cells,
    column sep=3ex,row sep=1ex,ampersand replacement=\&,left delimiter=(,right delimiter=)] {
      \red{a_{11}} \& a_{12} \& \red{a_{13}}  \& \red{a_{14}} \& a_{15}\\
      \red{0} \& 0 \& \red{a_{23}}  \& \red{a_{24}} \& a_{25}\\
      \red{0} \& 0 \& \red{0}  \& \red{a_{34}} \& a_{35}\\
      \red{0} \& 0 \& \red{0}  \& \red{0} \& 0\\
    };
  \end{tikzpicture}
\end{figure}


去掉向量组
$$B:\betabd_1,\betabd_2,\betabd_3,\betabd_4,\betabd_5$$
的最后一个分量，
所得的新向量记为
$$B^*:\betabd_1^*,\betabd_2^*,\betabd_3^*,\betabd_4^*,\betabd_5^*.$$
注意去掉的分量全为$0$，故这两个向量组的相关性是一致的。

\vspace{0.1in}

由$\betabd_1,\betabd_3,\betabd_4$线性无关，
则$\betabd_1^*,\betabd_3^*,\betabd_4^*$也线性无关。

\vspace{0.1in}


因任意$(3+1)=4$个$3$维向量必线性相关，
故$\betabd_1^*,\betabd_3^*,\betabd_4^*$为向量组$B^*$的极大无关组，
即向量组$B^*$中任何一个向量都可由$\betabd_1^*,\betabd_3^*,\betabd_4^*$线性表示，
从而向量组$B$的任何一个向量都可以由$\betabd_1,\betabd_3,\betabd_4$线性表示。

\vspace{0.1in}

得证$\betabd_1,\betabd_3,\betabd_4$是向量组$B$的极大无关组，即矩阵$\A$的列秩为$3$。





\begin{jielun}
  阶梯形矩阵的行秩等于列秩，其值等于阶梯形矩阵的非零行的行数。
\end{jielun}






\begin{dingli}
  初等行变换不改变矩阵的行秩。
\end{dingli}
\begin{proof}
  只需证明每做一次对换、倍乘和倍加变换，矩阵的行秩不改变。    
  \vspace{0.1in}

  设$\A$是$m\times n$矩阵，进行一次初等变换所得矩阵为$\B$。记$\A$的行向量为
  $$\red{A:~\alphabd_1,\alphabd_2,\cd,\alphabd_m.}$$      
  \begin{itemize}
  \item[(1)] 证明对换变换不改变矩阵的行秩。 
    $$
    \A \xlongrightarrow[]{r_i\leftrightarrow r_j}\B
    $$
    因$\B$的行向量组
    $$\red{B:~\alphabd_1,\alphabd_2,\cd,\blue{c\alphabd_j},,\cd,\blue{c\alphabd_i},\cd,\alphabd_m}$$
    与$\A$的行向量组$$\red{B:~\alphabd_1,\alphabd_2,\cd,\blue{c\alphabd_i},,\cd,\blue{c\alphabd_j},\cd,\alphabd_m}$$
    一致，故$\B$的行秩等于$\A$的行秩。 \\[0.1in] 
  \end{itemize}
  




  
  \begin{itemize}
  \item[(2)] 证明倍乘变换不改变矩阵的行秩。 
    $$
    \A \xlongrightarrow[]{r_i\times c }\B,
    $$
    其中$c\ne 0$。因$\B$的行向量组
    $$\red{B:~\alphabd_1,\alphabd_2,\cd,\blue{c\alphabd_i},\cd,\alphabd_m}$$
    与$\A$的行向量组
    $$\red{A:~\alphabd_1,\alphabd_2,\cd,\blue{\alphabd_i},\cd,\alphabd_m}$$
    等价，故$\B$的行秩等于$\A$的行秩。
  \end{itemize}
  



  
  \begin{itemize}
  \item[(3)] 证明倍乘变换不改变矩阵的行秩。 
    $$
    \A \xlongrightarrow[]{r_i+ r_j \times c  }\B,
    $$
    因$\B$的行向量组
    $$B:~\alphabd_1,\alphabd_2,\cd,\red{\alphabd_i+c\alphabd_j},\cd,\alphabd_m$$
    与$\A$的行向量组
    $$\red{A:~\alphabd_1,\alphabd_2,\cd,\blue{\alphabd_i},\cd,\alphabd_m}$$
    等价，故$\B$的行秩等于$\A$的行秩。
  \end{itemize}
\end{proof}





\begin{dingli}
  初等行变换不改变矩阵的列秩。
\end{dingli}
\begin{proof}
  设
  $$
  \A = (\alphabd_1,\alphabd_2,\cd,\alphabd_m) \xlongrightarrow[]{\mbox{初等行变换}}
  (\betabd_1,\betabd_2,\cd,\betabd_m) = \B
  $$ 
  在$\A,\B$中相同位置任取某$s$个列向量：
  $$
  \alphabd_{i_1},\alphabd_{i_2},\cd,\alphabd_{i_s} \mbox{~~和~~}
  \betabd_{i_1},\betabd_{i_2},\cd,\betabd_{i_s},
  $$
  分别记为向量组$A^*$和$B^*$。设
  \begin{eqnarray}
    x_1\alphabd_{i_1}+x_2\alphabd_{i_2}+\cd+x_s\alphabd_{i_s} =\zero, \label{thm3.3.2-1}\\[0.1in]
    x_1\betabd_{i_1}+x_2\betabd_{i_2}+\cd+x_s\betabd_{i_s} =\zero, \label{thm3.3.2-2}
  \end{eqnarray} 
  注意到方程组(\ref{thm3.3.2-2})是方程组(\ref{thm3.3.2-1})经过高斯消元法得到，故两方程组同解。 即向量组$A^*$和$B^*$有完全相同的线性关系。得证$\A,\B$列秩相等。
\end{proof}

定理3.3.2提供了求向量组的秩与极大无关组的一种简便而有效的方法。





\begin{li}{例1}
  设向量组
  $$
  \alphabd_1=\left(
    \begin{array}{r}
      -1\\-1\\0\\0
    \end{array}
  \right),~~ \alphabd_2=\left(
    \begin{array}{r}
      1\\2\\1\\-1
    \end{array}
  \right),~~ \alphabd_3=\left(
    \begin{array}{r}
      0\\1\\1\\-1
    \end{array}
  \right),~~ \alphabd_4=\left(
    \begin{array}{r}
      1\\3\\2\\1
    \end{array}
  \right),~~ \alphabd_5=\left(
    \begin{array}{r}
      2\\6\\4\\-1
    \end{array}
  \right)
  $$
  求向量组的秩及其一个极大无关组，并将其余向量用该极大无关组线性表示。
\end{li}
\begin{jie}
作矩阵$\A=(\alphabd_1,\alphabd_2,\alphabd_3,\alphabd_4,\alphabd_5)$，由
$$
\begin{array}{rl}
  \A &= \left(
       \begin{array}{rrrrr}
         -1&1&0&1&2\\
         -1&2&1&3&6\\
         0&1&1&2&4\\
         0&-1&-1&1&-1
       \end{array}
                    \right) \xlongrightarrow[r_2+r_1]{ r_1\times(-1)}
                    \left(
                    \begin{array}{rrrrr}
                      1&-1&0&-1&-2\\
                      0&1&1&2&4\\
                      0&1&1&2&4\\
                      0&-1&-1&1&-1
                    \end{array}
                                 \right)\\[0.4in]
     &\xlongrightarrow[r_4+r_2]{r_3- r_2}
       \left(
       \begin{array}{rrrrr}
         1&-1&0&-1&-2\\
         0&1&1&2&4\\
         0&0&0&0&0\\
         0&0&0&3&3
       \end{array}
                  \right) \xlongrightarrow[r_3\leftrightarrow r_4]{r_4\div 3}
                  \left(
                  \begin{array}{rrrrr}
                    1&-1&0&-1&-2\\
                    0&1&1&2&4\\
                    0&0&0&1&1\\
                    0&0&0&0&0
                  \end{array}
                             \right)
\end{array}
$$

$$
\begin{array}{rl}
  & \xlongrightarrow[r_2 -2 r_3]{r_1+r_3}
    \left(
    \begin{array}{rrrrr}
      1&-1&0&0&-1\\
      0&1&1&0&2\\
      0&0&0&1&1\\
      0&0&0&0&0
    \end{array}
               \right) \xlongrightarrow[]{r_1+r_2}
               \left(
               \begin{array}{rrrrr}
                 1&0&1&0&1\\
                 0&1&1&0&2\\
                 0&0&0&1&1\\
                 0&0&0&0&0
               \end{array}
                          \right) = \B
\end{array}
$$
将最后一个阶梯矩阵$\B$记为$(\betabd_1,\betabd_2,\betabd_3,\betabd_4,\betabd_5)$

易知$\betabd_1,\betabd_2,\betabd_4$为$\B$的列向量组的一个极大无关组，故$\alphabd_1,\alphabd_2,\alphabd_4$也为$\A$的列向量组的一个极大无关组，故
$$
\rank(\alphabd_1,\alphabd_2,\alphabd_3,\alphabd_4,\alphabd_5)=3,
$$
且
$$
\begin{array}{l}
  \alphabd_3=\alphabd_1+\alphabd_2,\\
  \alphabd_5=\alphabd_1+2\alphabd_2+\alphabd_4,\\
\end{array}
$$

\end{jie}






由定理3.3.1与定理3.3.2可以推出：
\purple{初等列变换也不改变矩阵的列秩与行秩。}

\begin{dingli}
  初等变换不改变矩阵的行秩与列秩。
\end{dingli}


\begin{dingli}
  矩阵的行秩等于其列秩。
\end{dingli}
\begin{proof}
对$\A$做初等行变换得到阶梯矩阵$\U$，则有
$$
\begin{array}{rl}
  \A\mbox{的行秩}&=\U\mbox{的行秩}\\[0.1in]
                 &=\U\mbox{的列秩}=\A\mbox{的列秩}
\end{array}
$$
\end{proof}

\begin{dingyi}[矩阵的秩]
  矩阵的行秩或列秩的数值，称为\red{矩阵的秩}。记作
  $$
  \rank(\A)  \quad \mbox{或} \quad 
  \mathrm{R} (\A)  \quad \mbox{或} \quad
  \mathrm{rank} (\A)
  $$
\end{dingyi}

\begin{dingyi}[满秩矩阵]
  对于$n$阶方阵，若
  $$
  \rank(\A) = n,
  $$
  则称$\A$为\red{满秩矩阵}。
\end{dingyi}

\begin{dingli}
  对于$n$阶方阵，下列表述等价：
  \begin{itemize}
  \item[(1)] $\A$为满秩矩阵。
  \item[(2)] $\A$为可逆矩阵。
  \item[(3)] $\A$为非奇异矩阵。
  \item[(4)] $\A\ne 0$。
  \end{itemize}
\end{dingli}
\begin{proof}
只需证明前两个表述等价。 

\begin{itemize}
\item [\red{(1)$\Rightarrow$(2)}]    
  设$\rank(\A)=n$，记$\A$的行简化阶梯形矩阵为$\B$，则$\B$有$n$个非零行， 由行简化阶梯形矩阵的结构知
  $
  \B=\II,
  $ 
  即存在可逆矩阵$\PP$使得
  $$
  \PP\A=\II,
  $$
  故$\A^{-1}=\PP$，即$\A$可逆。
\item [\red{(2)$\Rightarrow$(1)}]   
  若$\A$可逆，记$\A^{-1}=\PP_0$，则
  $$
  \PP_0\A=\II,
  $$ 
  即$\A$经过初等行变换可以得到$\II$，故$\rank(\A)=\rank(\II)=n$。
\end{itemize}
\end{proof}





\begin{dingyi}[子式与主子式]
  对矩阵$\A=(a_{ij})_{m\times n}$，任意挑选$k$行($i_1,i_2,\cd,i_k$行)与$k$列($j_1,j_2,\cd,j_k$列)，
  其交点上的$k^2$个元素按原顺序排成的$k$阶行列式
  \begin{equation}\label{subdet}
    \left|
      \begin{array}{cccc}
        a_{i_1j_1} & a_{i_1j_2} & \cd & a_{i_1j_k}\\
        a_{i_2j_1} & a_{i_2j_2} & \cd & a_{i_2j_k}\\
        \vd & \vd && \vd\\
        a_{i_kj_1} & a_{i_kj_2} & \cd & a_{i_kj_k}\\
      \end{array}
    \right|
  \end{equation}
  称为$\A$的\red{$k$阶子行列式}，简称$\A$的\red{$k$阶子式}。 
  \begin{itemize}
  \item 当(\ref{subdet})等于零时，称为\red{$k$阶零子式};
  \item 当(\ref{subdet})不等于零时，称为\red{$k$阶非零子式};
  \item 当(\ref{subdet})的$j_1=i_1,~j_2=i_2,~\cd,~j_k=i_k$，称为$\A$的\red{$k$阶主子式}。
  \end{itemize}
\end{dingyi}





\begin{zhu}
  若$\A$存在$r$阶非零子式，而所有$r+1$阶子式(如果有)都等于零，则矩阵$\A$的非零子式的最高阶数为$r$。
\end{zhu}

事实上，由行列式的按行展开可知，若所有$r+1$阶子式都等于零，可得到所有更高阶的子式都等于零。





\begin{dingli}
  $\rank(\A)=r$的充分必要条件是$\A$的非零子式的最高阶数为$r$。
\end{dingli}
\begin{proof}
\begin{itemize}
\item[$(\Rightarrow)$] 设$\rank(\A)=r$，即$\A$的行秩为$r$，不妨设$\A$的前$r$行构成的矩阵$\A_1$的行秩为$r$，
  其列秩也为$r$；不妨设$\A_1$的前$r$个列向量线性无关。\vspace{0.05in}  

  由定理3.3.5可知，$\A$的左上角$r$阶子式为非零子式。\vspace{0.05in}  

  又因为$\A$的任意$r+1$个行向量线性相关，所以$\A$的任意$r+1$阶子式都是零子式（\purple{因为其中有一行可由其余$r$行线性表示}），
  因此$\A$的非零子式的最高阶数为$r$。 \vspace{0.05in}  

\item[$(\Leftarrow)$] 
  不妨设$\A$的左上角$r$阶子式$|\A_r|\ne 0$，于是$\A_r$可逆，其$r$个行向量线性无关。
  将它们添加分量称为$\A$的前$r$个行向量，它们也线性无关。\vspace{0.05in}  

  而$\A$的任何$r+1$个行向量必线性相关（\purple{否则，$\A$中存在$r+1$阶非零子式，这与题设矛盾}），故$\A\mbox{的行秩}=\rank(\A)=r$.
\end{itemize}
\end{proof}


关于矩阵的秩的基本结论
\begin{itemize}
\item[(1)]  $\red{\rank(\A)=\A\mbox{的行秩}=\A\mbox{的列秩}=\A\mbox{的非零子式的最高阶数}}$
\item[(2)]  \red{初等变换不改变矩阵的秩}
\end{itemize}


\begin{xingzhi}
  $$
  \red{\max\{\rank(\A),~\rank(\B)\}~~\le~~ \rank(\A,~\B) ~~\le~~ \rank(\A) + \rank(\B).}
  $$
  特别地，当$\B=\bb$为非零向量时，有
  $$
  \red{\rank(\A)~~\le~~\rank(\A,~\bb)~~\le~~\rank(\A)+1.}
  $$
\end{xingzhi}

$$
\rank(\A,\bb) = \left\{
  \begin{array}{ll}
    \rank(\A) & \Longleftrightarrow~~ \bb\mbox{可以被}\A\mbox{的列向量线性表示}\\[0.1in]
    \rank(\A)+1 & \Longleftrightarrow~~ \bb\mbox{不能被}\A\mbox{的列向量线性表示}
  \end{array}
\right.
$$





设$$\A=\left(
  \begin{array}{cc}
    1&0\\
    0&1\\
    0&0
  \end{array}
\right),$$
\begin{itemize}
\item[(1)] 取$\bb=\left(
    \begin{array}{cc}
      1\\
      2\\
      0
    \end{array}
  \right)$，则
  $$
  (\A,~\bb) = \left(
    \begin{array}{ccc}
      1&0&\red{1}\\
      0&1&\red{2}\\
      0&0&\red{0}
    \end{array}
  \right) \xlongrightarrow[]{c_3-(c_1+2c_2)}
  \left(
    \begin{array}{ccc}
      1&0&\red{0}\\
      0&1&\red{0}\\
      0&0&\red{0}
    \end{array}
  \right) = (\A, \zero),
  $$
  故$\rank(\A,\bb)=\rank(\A,\zero)=\rank(\A)$。\\[0.1in]  
\item[(2)] 取$\bb=\left(
    \begin{array}{cc}
      0\\
      0\\
      1
    \end{array}
  \right)$，则
  $$
  (\A,~\bb) = \left(
    \begin{array}{ccc}
      1&0&\red{0}\\
      0&1&\red{0}\\
      0&0&\red{1}
    \end{array}
  \right),
  $$
  $\bb$不能由$\A$的列向量线性表示，故
  $\rank(\A,\bb)=\rank(\A)+1.$
\end{itemize}

\begin{proof}
\begin{itemize}
\item
  因为$\A$的列均可由$(\A,\B)$的列线性表示，故
  $$
  \rank(\A) \le \rank(\A,\B),
  $$  
  同理
  $$
  \rank(\B) \le \rank(\A,\B),
  $$ 
  所以
  $$
  \max\{\rank(\A),~\rank(\B)\} \le \rank(\A,\B),
  $$ 
\item  
  设$\rank(\A)=p, ~\rank(\B)=q$，%将$\A,\B$按列分块为
  %% $$
  %% \A=(\alphabd_1,~\cd,~\alphabd_n), ~~
  %% \B=(\betabd_1,~\cd,~\betabd_n).
  %% $$  
  $\A$和$\B$的列向量组的极大无关组分别为
  $$
  \alphabd_1,~\cd,~\alphabd_p \mbox{~~和~~}
  \betabd_1,~\cd,~\betabd_q.  
  $$  
  显然$(\A,~\B)$的列向量组可由向量组$\alphabd_1,~\cd,~\alphabd_p,~
  \betabd_1,~\cd,~\betabd_q$线性表示，故
  $$
  \rank(\A,~\B) = (\A,~\B)\mbox{的列秩} \le \rank(\alphabd_1,~\cd,~\alphabd_p,~
  \betabd_1,~\cd,~\betabd_q) \le p+q.
  $$
\end{itemize}

\end{proof}


\begin{zhu}
  \begin{itemize}
  \item 不等式
    $$
    \min\{\rank(\A),~\rank(\B)\} ~~\le~~ \rank(\A,~\B)
    $$
    意味着：在$\A$的右侧添加新的列，只有可能使得秩在原来的基础上得到增加；当$\B$的列向量能被$\A$的列向量线性表示时，等号成立。\\[0.1in] 
  \item 不等式
    $$
    \rank(\A,~\B) ~~\le~~ \rank(\A)+\rank(\B)
    $$
    意味着：对$(\A,~\B)$，有可能$\A$的列向量与$\B$的列向量出现线性相关，合并为$(\A,~\B)$的秩一般会比$\rank(\A)+\rank(\B)$要小。
  \end{itemize}
\end{zhu}



\begin{xingzhi}
  $$
  \red{\rank(\A+\B) \le \rank(\A)+\rank(\B).}
  $$
\end{xingzhi}
\begin{proof}
设$\rank(\A)=p, ~\rank(\B)=q$，
$\A$和$\B$的列向量组的极大无关组分别为
$$
\alphabd_1,~\cd,~\alphabd_p \mbox{~~和~~}
\betabd_1,~\cd,~\betabd_q.  
$$  
显然$\A+\B$的列向量组可由向量组$\alphabd_1,~\cd,~\alphabd_p,~
\betabd_1,~\cd,~\betabd_q$线性表示，故
$$
\rank(\A+\B) = \A+\B\mbox{的列秩} \le \rank(\alphabd_1,~\cd,~\alphabd_p,~
\betabd_1,~\cd,~\betabd_q) \le p+q.
$$
\end{proof}
\begin{zhu}
  将矩阵$\A$和$\B$合并、相加，只可能使得秩减小。
\end{zhu}

\begin{xingzhi}
  $$
  \red{\rank(\A\B) \le \min(\rank(\A),~\rank(\B)).}
  $$
\end{xingzhi}

\begin{proof}
设$\A,\B$分别为$m\times n, n\times s$矩阵，将$\A$按列分块，则
$$
\A\B = (\alphabd_1,~\cd,~\alphabd_n) \left(
  \begin{array}{cccc}
    b_{11}&b_{12}&\cd&b_{1s}\\
    b_{21}&b_{22}&\cd&b_{2s}\\
    \vd&\vd&&\vd\\
    b_{n1}&b_{n2}&\cd&b_{ns}
  \end{array}
\right).
$$  
由此可知，$\A\B$的列向量组可由$\alphabd_1,~\alphabd_2,~\cd,~\alphabd_n$线性表示，故
$$
\rank(\A\B) = \A\B\mbox{的列秩} \le \A\mbox{的列秩} = \rank(\A).
$$
类似地，将$\B$按行分块，可得$$\rank(\A\B)\le \rank(\B).$$
\end{proof}
该性质告诉我们，对一个向量组进行线性组合，可能会使向量组的秩减小。

\begin{xingzhi}
  设$\A$为$m\times n$矩阵，$\PP,\QQ$分别为$m$阶、$n$阶可逆矩阵，则
  $$
  \rank(\A) = \rank(\PP\A) = \rank(\A\QQ)  = \rank(\PP\A\QQ).
  $$
\end{xingzhi}
\begin{proof}
  以下给出两种证明方法：
\begin{itemize}
\item[法一] 
  可逆矩阵$\PP,~\QQ$可表示为若干个初等矩阵的乘积，而初等变换不改变矩阵的秩，故结论成立。 
\item[法二]
  因
  $$
  \rank(\A) = \rank(\PP^{-1}(\PP\A)) \le \rank(\PP\A) \le \rank(\A)
  $$
  故
  $$
  \rank(\A) = \rank(\PP\A).
  $$
  
  同理可证其他等式。
\end{itemize}

\end{proof}

\begin{li}
  设$\A$是$m\times n$矩阵，且$m<n$，证明：$|\A^T\A|=0$.
\end{li}
\begin{jie}
由于$\rank(\A)=\rank(\A^T)\le \min\{m,n\}<n$，根据性质2，有
$$
\rank(\A^T\A) \le \min\{\rank(\A^T),~\rank(\A)\} < n,
$$
而$\A^T\A$为$n$阶矩阵，故$|\A^T\A|=0$。
\end{jie}

\begin{dingyi}[矩阵的相抵]
  若矩阵$\A$经过初等变换化为$\B$(\purple{亦即存在可逆矩阵$\PP$和$\QQ$使得$\PP\A\QQ=\B$})，就称$\A$\red{相抵于}$\B$，记作$\A\cong\B$
\end{dingyi}

\begin{xingzhi}[相抵关系的性质]
  \begin{itemize}
  \item 反身性
    $$
    \A\cong\A
    $$
  \item 对称性
    $$
    \A\cong\B ~~\Rightarrow~~ \B\cong\A
    $$
  \item 传递性
    $$
    \A\cong\B,~~\B\cong\C ~~\Rightarrow~~ \A\cong\C
    $$
  \end{itemize}
\end{xingzhi}


\begin{dingyi}[阶梯形矩阵]
  若矩阵$\A$满足
  \begin{itemize}
  \item[(1)] 零行在最下方；
  \item[(2)] 非零行首元的列标号随行标号的增加而严格递增，
  \end{itemize}
  则称$\A$为\red{阶梯形矩阵}。
\end{dingyi}

\begin{li}
  $$
  \left(
    \begin{array}{rrrr}
      2&0&2&1\\
      0&5&2&-2\\
      0&0&3&2\\
      0&0&0&0
    \end{array}
  \right)
  $$
\end{li}


\begin{dingyi}{行简化阶梯形矩阵}
  若矩阵$\A$满足
  \begin{itemize}
  \item[(1)] 它是阶梯形矩阵；
  \item[(2)] 非零行首元所在的列除了非零行首元外，其余元素全为零，
  \end{itemize}
  则称$\A$为\red{行简化阶梯形矩阵}。
\end{dingyi}

\begin{li}
  $$
  \left(
    \begin{array}{rrrr}
      2&0&0&1\\
      0&5&0&-2\\
      0&0&3&2\\
      0&0&0&0
    \end{array}
  \right)
  $$
\end{li}



\begin{dingli}
  若$\A$为$m\times n$矩阵，且$\rank(\A)=r$，则一定存在可逆的$m$阶矩阵$\PP$和$n$阶矩阵$\QQ$使得
  $$
  \PP\A\QQ=\left(
    \begin{array}{cc}
      \II_r&\zero\\
      \zero&\zero
    \end{array}
  \right)_{m\times n} = \U.
  $$
\end{dingli}
\begin{proof}
对$\A$做初等行变换，可将$\A$化为有$r$个非零行的行简化阶梯形矩阵，即存在初等矩阵$\PP_1,\PP_2,\cd,\PP_s$使得
$$
\PP_s\cd\PP_2\PP_1\A=\U_1.
$$

对$\U_1$做初等列变换可将$\U_1$化为$\U$，即存在初等矩阵$\QQ_1,\QQ_2,\cd,\QQ_t$使得
$$
\U_1\QQ_1\QQ_2\cd\QQ_t=\U
$$

记
$$
\purple{\PP_s\cd\PP_2\PP_1=\PP, ~~\QQ_1\QQ_2\cd\QQ_t=\QQ,}
$$
则有
$$
\PP\A\QQ=\U.
$$
\end{proof}

\begin{dingyi}[相抵标准形]
  设$\rank(\A_{m\times n})=r$，则矩阵
  $$
  \left(
    \begin{array}{cc}
      \II_r&\zero\\
      \zero&\zero
    \end{array}
  \right)_{m\times n} 
  $$称为$\A$的\blue{相抵标准形}，简称\blue{标准形}。
\end{dingyi}

\begin{itemize}
\item 秩相等的同型矩阵，必有相同的标准形。
\item 两个秩相等的同型矩阵是相抵的。
\end{itemize}

\begin{li}
  设$\A$为$m\times n$矩阵($m>n$)，$\rank(\A)=n$，证明：存在$n\times m$矩阵$\B$使得
  $$
  \B\A=\II_n.
  $$
\end{li}
\begin{proof}
由定理3.3.7可知，存在$m$阶可逆矩阵$\PP$与$n$阶可逆矩阵$\QQ$使得
$$
\PP\A\QQ=\left(
  \begin{array}{c}
    \II_n\\
    \zero_1
  \end{array}
\right)     
~~~\Rightarrow~~~
\PP\A=\left(
  \begin{array}{c}
    \II_n\\
    \zero_1
  \end{array}
\right)\QQ^{-1}=\left(
  \begin{array}{c}
    \QQ^{-1}\\
    \zero_1
  \end{array}
\right)
$$
其中$\zero_1$为$(m-n)\times n$零矩阵。
取
$$
\C=(\QQ~~\zero_2),
$$
其中$\zero_2$为$n\times(m-n)$阶零矩阵， 则
$$
\C\PP\A=(\QQ~~\zero_2)\left(
  \begin{array}{c}
    \QQ^{-1}\\
    \zero_1
  \end{array}
\right)=\QQ\QQ^{-1}+\zero_2\zero_1=\II_n.
$$ 
故存在$\B=\C\PP$使得
$$
\B\A=\II_n.
$$
\end{proof}

\begin{li}
  设$\alphabd_1=(1,3,1,2), ~\alphabd_2=(2,5,3,3), ~\alphabd_3=(0,1,-1,a), ~\alphabd_4=(3,10,k,4)$，
  试求向量组$\alphabd_1,~\alphabd_2,~\alphabd_3,~\alphabd_4$的秩，并将$\alphabd_4$用$\alphabd_1,~\alphabd_2,~\alphabd_3$线性表示。
\end{li}
\begin{jie}
将4个向量按列排成一个矩阵$\A$，对$\A$进行初等变换，将其化为阶梯形矩阵$\U$，即
$$
\A=\left(
  \begin{array}{rrrr}
    1&2&0&3\\
    3&5&1&10\\
    1&3&-1&k\\
    2&3&a&4
  \end{array}
\right) \xlongrightarrow[]{\mbox{初等行变换}}
\left(
  \begin{array}{rrcc}
    1&2&0&3\\
    0&-1&1&1\\
    0&0&a-1&-3\\
    0&0&0&k-2
  \end{array}
\right)
$$

\begin{itemize}
\item[(1)] 当$a=1$或$k=2$时，$\U$只有3个非零行，故
  $$\rank(\alphabd_1,\alphabd_2,\alphabd_3,\alphabd_4)=\rank(\A)=3. $$ 
\item[(2)]  当$a\ne1$且$k\ne2$时，
  $$\rank(\alphabd_1,\alphabd_2,\alphabd_3,\alphabd_4)=\rank(\A)=4.$$
\item[(3)] 当$k=2$且$a\ne1$时，$\alphabd_4$可由$\alphabd_1,~\alphabd_2,~\alphabd_3$线性表示，
  且
  $$
  \alphabd_4=-\frac{1+5a}{1-a}\alphabd_1+\frac{2+a}{1-a}\alphabd_2+\frac{3}{1-a}\alphabd_3.
  $$
\item[(4)]  当$k\ne2$或$a=1$时，$\alphabd_4$不能由$\alphabd_1,~\alphabd_2,~\alphabd_3$线性表示。
\end{itemize}

\end{jie}








\begin{li}
  设
  $$
  \A=\left(
    \begin{array}{rrr}
      1&2&1\\
      2&2&-2\\
      -1&t&5\\
      1&0&-3
    \end{array}
  \right)
  $$
  已知$\rank(\A)=2$，求$t$。
\end{li}
\begin{jie}
$$
\A \xlongrightarrow[]{\mbox{初等行变换}} \left(
  \begin{array}{ccr}
    1&2&1\\
    0&-2&-4\\
    0&2+t&6\\
    0&0&0
  \end{array}
\right)=\B
$$ 
由于$\rank(\B)=\rank(\A)$，故$\B$中第2、3行必须成比例，即
$$
\frac{-2}{2+t}=\frac{-4}6,
$$
即得$t=1$。
\end{jie}






% \begin{li}
%   已知$\rank(\B)=2$，
%   $$
%   \A=\left(
%     \begin{array}{ccc}
%       1&2&0\\
%       0&a&1\\
%       1&3&b
%     \end{array}
%   \right).
%   $$
%   问
%   \begin{itemize}
%   \item[(1)] $a,b$满足什么条件时，$\rank(\A\B)=2$；
%   \item[(2)] $\A$与$\B$满足什么条件时，$\rank(\A\B)=1$。
%   \end{itemize}
% \end{li}
% \begin{jie}
% \begin{itemize}
% \item[(1)] 当$\A$可逆时，$\rank(\A\B)=\rank(\B)=2$。此时，
%   $$
%   |\A| = ab-1\ne 0.
%   $$
% \item[(2)] 当$ab-1=0$时，$\A$不可逆，且$\rank(\A)=2$。
%   $\A$的列向量组线性相关，故$\A\xx=\zero$有非零解。
% \end{itemize}
% \end{jie}
