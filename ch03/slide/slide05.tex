\section{非齐次线性方程组有解的条件及解的结构}
\begin{frame}
\begin{dingli}
  对于非齐次线性方程组$\MA\vx=\vb$，以下命题等价：
  \begin{itemize}
  \item[(i)] $\MA\vx=\vb$有解；
  \item[(ii)] $\vb$可由$\MA$的列向量组线性表示；
  \item[(iii)] $\rank(\MA,\vb)=\rank(\MA)$。
  \end{itemize}
\end{dingli}
\end{frame}

\begin{frame}
\begin{proof}
  分两步证明：
  \begin{itemize}
  \item[(i)$\Leftrightarrow$(ii)] 记$\MA=(\alphabd_1,\alphabd_2,\cd,\alphabd_n)$，则$\MA\vx=\vb$等价于
    $$
    x_1\alphabd_1+x_2\alphabd_2+\cd+x_n\alphabd_n=\vb.
    $$ \pause 
  \item[(ii)$\Leftrightarrow$(iii)] 若$\vb$可由$\MA$的列向量组$\alphabd_1,\alphabd_2,\cd,\alphabd_n$线性表示，则$(\MA,\vb)$的列向量组与$\MA$的列向量组等价，故$\rank(\MA,\vb)=\rank(\MA)$。    
    反之，若$\rank(\MA,\vb)=\rank(\MA)$，则$\vb$能由向量组$\alphabd_1,\alphabd_2,\cd,\alphabd_n$线性表示，否则$\rank(\MA,\vb)=\rank(\MA)+1$，导致矛盾。
  \end{itemize}
\end{proof}
\end{frame}

\begin{frame}
\begin{zhu}
  $\rank(\MA,\vb)=\rank(\MA)+1$会导致矛盾方程的出现
\end{zhu}
记$\rank(\MA)=r$，若$\rank(\MA,\vb)=\rank(\MA)+1$，则增广矩阵$(\MA,\vb)$经过初等行变换所得的行阶梯形矩阵形如
\begin{center}
  \begin{tikzpicture}
    \matrix(MM) [matrix of math nodes,nodes in empty cells,ampersand replacement=\&,left delimiter=(,right delimiter=)] {
      1\&\cd\&c_{1r}\&c_{1,r+1}\&\cd\&c_{1n}\&\&d_1\\        
      \vd\&\&\vd\&\vd\&\&\vd\&\&\vd\\
      0\&\cd\&1\&c_{r,r+1}\&\cd\&c_{rn}\&\&d_r\\
      0\&\cd\&0\&0\&\cd\&0\&\&\red{d_{r+1}}\\
      0\&\cd\&0\&0\&\cd\&0\&\&0\\        
      \vd\&\&\vd\&\vd\&\&\vd\&\&\vd\\
      0\&\cd\&0\&0\&\cd\&0\&\&0\\
    };  
    \draw[thick,dashed] (MM-1-7.north)--(MM-7-7.south);
  \end{tikzpicture}
\end{center}
其中$d_{r+1}\ne 0$（否则$\rank(\MA,\vb)=r$）。这意味着出现了矛盾方程
$$
0 = \red{d_{r+1}}.
$$    
\end{frame}

\begin{frame}
\begin{tuilun}
  $$
  \MA\vx=\vb\mbox{有唯一解} ~~\Longleftrightarrow~~
  \rank(\MA,\vb)=\rank(\MA)=\MA\mbox{的列数}.
  $$
\end{tuilun}
\begin{center}
  \begin{tikzpicture}
    \matrix(MM) [matrix of math nodes,nodes in empty cells,ampersand replacement=\&,left delimiter=(,right delimiter=)] {
      1\&\cd\&0\&\&d_1\\        
      \vd\&\&\vd\&\&\vd\\
      0\&\cd\&1\&\&d_r\\
      0\&\cd\&0\&\&0\\
      0\&\cd\&0\&\&0\\
      \vd\&\&\vd\&\&\vd\\
      0\&\cd\&0\&\&0\\
    };  
    \draw[thick,dashed] (MM-1-4.north)--(MM-7-4.south);
  \end{tikzpicture}
\end{center}
\end{frame}

\begin{frame}
\begin{dingli}
  若$\vx_1,~\vx_2$是$\MA\vx=\vb$的解，则$\vx_1-\vx_2$是$\MA\vx=\M0$的解。
\end{dingli}
\pause 
\begin{proof}
$$
\MA(\vx_1-\vx_2)=\MA\vx_1-\MA\vx_2=\vb-\vb=\M0,
$$
故$\vx_1-\vx_2$是$\MA\vx=\M0$的解。
\end{proof}
\end{frame}

\begin{frame}
\begin{dingli}
  若$\MA\vx=\vb$有解，则其一般解（或称通解）为
  $$
  \vx=\vx_0+\bar\vx
  $$
  其中$\vx_0$是$\MA\vx=\vb$的一个特解，而
  $$
  \bar\vx=k_1\vx_1+k_2\vx_2+\cd+k_p\vx_p
  $$
  为$\MA\vx=\M0$的一般解。
\end{dingli}
\pause 
\begin{proof}
  $$
  \MA(\vx_0+\bar\vx)=\MA\vx_0+\MA\bar\vx=\vb ~~\Rightarrow~~
  \vx_0+\bar\vx\mbox{是}\MA\vx=\vb\mbox{的解}
  $$
  设$\vx^*$是$\MA\vx=\vb$的任意一个解，则$\vx^*-\vx_0$是$\MA\vx=\M0$的解，而
  $$
  \vx^*=\vx_0+(\vx^*-\vx_0).
  $$
  故$\vx^*$可表示为$\vx_0+\bar\vx$的形式。
\end{proof}
\end{frame}

\begin{frame}
非齐次线性方程组
$$\MA\vx=\vb$$
的通解为
$$
k_1\vx_1+k_2\vx_2+\cd+k_p\vx_p + \red{\vx_0}
$$
其中$\vx_1,\vx_2,\cd,\vx_p$为$\MA\vx=\M0$的基础解系，$\vx_0$为$\MA\vx=\vb$的一个特解。
\end{frame}

\begin{frame}
\begin{zhu}
  “$\MA\vx=\vb$的通解” =  “$\MA\vx=\M0$的通解” + “$\MA\vx=\vb$的特解”
\end{zhu}
\end{frame}

\begin{frame}
\begin{li}
  求非齐次线性方程组$\MA\vx=\vb$的一般解，其中增广矩阵为
  $$
  (\MA,\vb) = \left(
    \begin{array}{rrrrr}
      1&-1&-1& 1&\red{0}\\
      1&-1& 1&-3&\red{1}\\
      1&-1&-2& 3&\red{-\frac12}
    \end{array}
  \right)
  $$
\end{li}
\end{frame}

\begin{frame}[allowframebreaks]
\begin{jie}
  $$
  \begin{array}{rl}
    \left(
    \begin{array}{rrrrr}
      1&-1&-1& 1&\red{0}\\
      1&-1& 1&-3&\red{1}\\
      1&-1&-2& 3&\red{-\frac12}
    \end{array}
                  \right)  \xlongrightarrow[r_3-r_1]{r_2-r_1} &
                                                                \left(
                                                                \begin{array}{rrrrr}
                                                                  1&-1&-1& 1&\red{0}\\
                                                                  0& 0& 2&-4&\red{1}\\
                                                                  0& 0&-1& 2&\red{-\frac12}
                                                                \end{array}
                                                                              \right) \\[0.4in]
    \xlongrightarrow[r_2\div2]{r_1-r_3,r_3+\frac12r_2} &
                                                         \left(
                                                         \begin{array}{rrrrr}
                                                           1&-1&-1& 1&\red{0}\\
                                                           0& 0& 1&-2&\red{\frac12}\\
                                                           0& 0& 0& 0&\red{0}
                                                         \end{array}
                                                                       \right)
  \end{array}
  $$
  同解方程为
  $$
  \left\{
    \begin{array}{rcrcrcr}
      x_1&=&x_2&+&x_4&+&\frac12\\[0.1in]
      x_3&=&&&2x_4&+&\frac12
    \end{array}
  \right.
  $$
  亦即
  $$
  \left\{
    \begin{array}{rcrcrcr}
      x_1&=&x_2&+&x_4&+&\frac12\\[0.1in]
      x_2&=&x_2&&&&\\[0.1in]
      x_3&=&&&2x_4&+&\frac12\\[0.1in]
      x_4&=&&&x_4&&
    \end{array}
  \right.
  $$
  故通解为
  $$
  \left(
    \begin{array}{c}
      x_1\\x_2\\x_3\\x_4
    \end{array}
  \right) = c_1    \left(
    \begin{array}{c}
      1\\1\\0\\0
    \end{array}
  \right)+c_2    \left(
    \begin{array}{c}
      1\\0\\2\\1
    \end{array}
  \right)+    \left(
    \begin{array}{c}
      1/2\\0\\1/2\\0
    \end{array}
  \right) \quad c_1,c_2\in\mathbb R
  $$
\end{jie}
\end{frame}

\begin{frame}
\begin{li}[重要题型]
  设有线性方程组
  $$
  \left\{
    \begin{array}{rrrcr}
      (1+\lambda)x_1&+x_2&+x_3&=&0\\[0.05in]
      x_1&+(1+\lambda)x_2&+x_3&=&3\\[0.05in]
      x_1&+x_2&+(1+\lambda)x_3&=&\lambda
    \end{array}
  \right.
  $$
  问$\lambda$取何值时，此方程组
  \begin{itemize}
  \item[(1)]有唯一解？
  \item[(2)]无解？ 
  \item[(3)]有无穷多解？ 并在有无穷多解时求其通解。
  \end{itemize}
\end{li}
\end{frame}

\begin{frame}[allowframebreaks]
\begin{jie}
  $$
  |\MA|=\left|
    \begin{array}{ccc}
      1+\lambda&1&1\\
      1&1+\lambda&1\\
      1&1&1+\lambda
    \end{array}
  \right| = (3+\lambda)\lambda^2.
  $$
  故当$\lambda\ne0$且$\lambda\ne-3$时，有唯一解。
  当$\lambda=0$时，原方程组为
  $$
  \left\{
    \begin{array}{l}
      x_1+x_2+x_3=0,\\
      x_1+x_2+x_3=3,\\
      x_1+x_2+x_3=0      
    \end{array}
  \right.
  $$
  它为矛盾方程组，故无解。 \vspace{0.1in}

  当$\lambda=-3$时，增广矩阵为
  $$
  \left(
    \begin{array}{rrrr}
      -2&1&1&\red{0}\\
      1&-2&1&\red{3}\\
      1&1&-2&\red{-3}
    \end{array}
  \right) \xlongrightarrow[]{\mbox{初等行变换}}
  \left(
    \begin{array}{rrrr}
      1&0&-1&\red{-1}\\
      0&1&-1&\red{-2}\\
      0&0&0&\red{0}
    \end{array}
  \right)
  $$
  得同解方程组为
  $$
  \left\{
    \begin{array}{l}
      x_1=x_3-1\\[0.05in]
      x_2=x_3-2\\[0.05in]
      x_3=x_3
    \end{array}
  \right.
  $$
  通解为
  $$
  \left(
    \begin{array}{c}
      x_1\\x_2\\x_3
    \end{array}
  \right) = c\left(
    \begin{array}{c}
      1\\1\\1
    \end{array}
  \right)+\left(
    \begin{array}{r}
      -1\\-2\\0
    \end{array}
  \right) \quad c\in\mathbb R
  $$
\end{jie}
\end{frame}

\begin{frame}
\begin{li}
  设$\etabd^*$为$\MA\vx=\vb$的一个解，$\xibd_1,~\xibd_2,~\cd,~\xibd_{n-r}$为对应的齐次线性方程组的一个基础解系，证明：
  \begin{itemize}
  \item[(1)] $\etabd^*,~\xibd_1,~\xibd_2,~\cd,~\xibd_{n-r}$线性无关；
  \item[(2)] $\etabd^*,~\etabd^*+\xibd_1,~\etabd^*+\xibd_2,~\cd,~\etabd^*+\xibd_{n-r}$线性无关。
  \end{itemize}
\end{li}
\end{frame}

\begin{frame}
\begin{proof}
\begin{itemize}
\item[(1)] 假设$\etabd^*,~\xibd_1,~\xibd_2,~\cd,~\xibd_{n-r}$线性相关，而$\xibd_1,~\xibd_2,~\cd,~\xibd_{n-r}$线性无关，故$\etabd^*$可由$\xibd_1,~\xibd_2,~\cd,~\xibd_{n-r}$线性表示，从而$\etabd^*$为$\MA\vx=\M0$的解，这与$\etabd^*$为$\MA\vx=\vb$的解矛盾。故假设不成立，即$\etabd^*,~\xibd_1,~\xibd_2,~\cd,~\xibd_{n-r}$线性无关。 
\item[(2)] 显然，
  $$\etabd^*,~\xibd_1,~\xibd_2,~\cd,~\xibd_{n-r}
  \mbox{~~等价于~~} 
  \etabd^*,~\etabd^*+\xibd_1,~\etabd^*+\xibd_2,~\cd,~\etabd^*+\xibd_{n-r},$$  
  由题(1)结论可知
  $$
  \begin{aligned}
    &\rank(\etabd^*,~\etabd^*+\xibd_1,~\etabd^*+\xibd_2,~\cd,~\etabd^*+\xibd_{n-r})\\
    =& 
    \rank(\etabd^*,~\xibd_1,~\xibd_2,~\cd,~\xibd_{n-r}) = n-r+1
  \end{aligned}
  $$
  从而结论成立。
\end{itemize}
\end{proof}
\end{frame}

\begin{frame}
\begin{li}
  设$\etabd_1,~\etabd_2,~\cd,~\etabd_s$为$\MA\vx=\vb$的$s$个解，$k_1,~k_2,~\cd,~k_{s}$为实数，满足$k_1+k_2+\cd+k_s=1$。证明：
  $$
  \vx=k_1\etabd_1+k_2\etabd_2+\cd+k_s\etabd_s
  $$
  也是它的解。
\end{li} \pause 
\begin{proof}
$$
\begin{array}{rcl}
  \MA(k_1\etabd_1+k_2\etabd_2+\cd+k_{s}\etabd_{s})&=&
                                                     k_1\MA\etabd_1+k_2\MA\etabd_2+\cd+k_s\MA\etabd_s\\[0.05in]
                                                 &=&k_1\vb+k_2\vb+\cd+k_s\vb\\[0.05in]
                                                 &=&\vb.
\end{array}
$$
\end{proof}
\end{frame}

\begin{frame}
\begin{li}
  对于$\MA\vx=\vb$，$\rank(\MA)=r$，$\etabd_1,~\etabd_2,~\cd,~\etabd_{n-r+1}$为它的$n-r+1$个线性无关的解。证明它的任一解可表示为
  $$
  \vx=k_1\etabd_1+k_2\etabd_2+\cd+k_{n-r+1}\etabd_{n-r+1},
  $$
  其中$k_1+k_2+\cd+k_{n-r+1}=1$
\end{li}
\end{frame}

\begin{frame}[allowframebreaks]
\begin{proof}
取向量组
$
\blue{\etabd_2-\etabd_1,~~\etabd_2-\etabd_1,~~\cd,~\etabd_{n-r+1}-\etabd_1.}
$
下证该向量组为$\MA\vx=\M0$的一个基础解系。 
$$
(\etabd_1,~\etabd_2,~\cd,~\etabd_{n-r+1}) \xlongrightarrow[j=2,\cd,n-r+1]{c_j-c_1}
(\etabd_1,~\etabd_2-\etabd_1,~\cd,~\etabd_{n-r+1}-\etabd_1)
$$ 
$$
\begin{array}{rl}
  &\etabd_1,~\etabd_2,~\cd,~\etabd_{n-r+1}\mbox{线性无关}\\[0.1in]  
  \Rightarrow&\etabd_1,~\etabd_2-\etabd_1,~\cd,~\etabd_{n-r+1}-\etabd_1\mbox{线性无关}\\[0.1in]  
  \Rightarrow&\etabd_2-\etabd_1,~\cd,~\etabd_{n-r+1}-\etabd_1\mbox{线性无关}\\[0.1in]  
  \Rightarrow& \etabd_2-\etabd_1,~\cd,~\etabd_{n-r+1}-\etabd_1\mbox{为}\MA\vx=\M0
               \mbox{的基础解系}.      
\end{array}
$$
于是$\MA\vx=\vb$的任意一个解$\vx$可表示为
$$
\begin{array}{rl}
  & \vx = k_2(\etabd_2-\etabd_1)+\cd+k_{n-r+1}(\etabd_{n-r+1}-\etabd_1)+\red{\etabd_1}\\[0.1in] 
  \Rightarrow & 
                \vx = (1-k_2-\cd-k_{n+r-1})\etabd_1+k_2\etabd_2+\cd+k_{n-r+1}\etabd_{n-r+1}\\[0.1in]
  \Rightarrow & 
                \vx =k_1\etabd_1+k_2\etabd_2+\cd+k_{n-r+1}\etabd_{n-r+1}
\end{array}
$$
\end{proof}
\end{frame}


\begin{frame}
\begin{li}
  设四元齐次线性方程组
  $$
  (I):\left\{
    \begin{array}{l}
      x_1+x_2=0,\\
      x_2-x_4=0;
    \end{array}
  \right. \quad
  (II):\left\{
    \begin{array}{l}
      x_1-x_2+x_3=0,\\
      x_2-x_3+x_4=0.
    \end{array}
  \right.
  $$
  求
  \begin{itemize}
  \item[(1)] 方程组$(I)$与$(II)$的基础解系
  \item[(2)] 方程组$(I)$与$(II)$的公共解        
  \end{itemize}
\end{li}
\end{frame}

\begin{frame}
\begin{jie}
  (1)、因为
    $$
    (I) \Longleftrightarrow
    \left\{
      \begin{array}{rcr}
        x_1&=&-x_2\\[0.05in]
        x_4&=&x_2
      \end{array}
    \right. \Longleftrightarrow
    \left\{
      \begin{array}{rcrr}
        x_1&=&-x_2&\\[0.05in]
        x_2&=&x_2&\\[0.05in]
        x_3&=&&x_3\\[0.05in]
        x_4&=&x_2&
      \end{array}
    \right. 
    $$   
    故$(I)$的基础解系为
    $$
    \xibd_1=\left(
      \begin{array}{r}
        -1\\1\\0\\1
      \end{array}
    \right), \quad
    \xibd_2=\left(
      \begin{array}{r}
        0\\0\\1\\0
      \end{array}
    \right)
    $$
  \end{jie}
  \end{frame}

\begin{frame}
\begin{jie}[续]
  因为
  $$
  (II) \Longleftrightarrow
  \left\{
    \begin{array}{rcrr}
      x_1&=&x_2&-x_3\\[0.05in]
      x_4&=&-x_2&+x_3
    \end{array}
  \right. \Longleftrightarrow
  \left\{
    \begin{array}{rcrr}
      x_1&=&x_2&-x_3\\[0.05in]
      x_2&=&x_2&\\[0.05in]
      x_3&=&&x_3\\[0.05in]
      x_4&=&-x_2&+x_3
    \end{array}
  \right. 
  $$
  故$(II)$的基础解系为
  $$
  \xibd_1=\left(
    \begin{array}{r}
      1\\1\\0\\-1
    \end{array}
  \right), \quad
  \xibd_2=\left(
    \begin{array}{r}
      -1\\0\\1\\1
    \end{array}
  \right)
  $$
\end{jie}
\end{frame}

\begin{frame}
\begin{jie}[续]
  (2)、 方程$(I)$与$(II)$的公共解即为联立$(I)$与$(II)$所得新方程组的解：
    $$
    \left\{
      \begin{array}{l}
        x_1+x_2=0\\
        x_2-x_4=0\\
        x_1-x_2+x_3=0\\
        x_2-x_3+x_4=0
      \end{array}
    \right.
    $$
\end{jie}
\end{frame}

\begin{frame}
\begin{jie}[续]

    $$
    \begin{array}{rl}
      \left(
      \begin{array}{rrrr}
        1&1&0&0\\
        0&1&0&-1\\
        1&-1&1&0\\
        0&1&-1&1
      \end{array}
                \right) \xlongrightarrow[r_3-r_1]{r_4+r_2} & 
                                                             \left(
                                                             \begin{array}{rrrr}
                                                               1&1&0&0\\
                                                               0&1&0&-1\\
                                                               0&-2&1&0\\
                                                               0&2&-1&0
                                                             \end{array}
                                                                       \right) \\[0.3in]
      \xlongrightarrow[r_3\times(-1)]{r_3+r_4}&
                                                \left(
                                                \begin{array}{rrrr}
                                                  1&1&0&0\\
                                                  0&1&0&-1\\
                                                  0&2&-1&0\\
                                                  0&0&0&0
                                                \end{array}
                                                         \right)         
    \end{array}
    $$  
    即
    $$
    \left\{
      \begin{array}{rcr}
        x_1&=&-x_2\\
        x_2&=&x_2\\
        x_3&=&2x_2\\
        x_4&=&x_2
      \end{array}
    \right.  ~~ \Rightarrow ~~
    \vx = c\left(
      \begin{array}{r}
        -1\\1\\2\\1
      \end{array}
    \right) \quad c\in \mathbb R.
    $$
\end{jie}
\end{frame}





